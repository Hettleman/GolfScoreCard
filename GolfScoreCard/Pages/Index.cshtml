@page
@model GolfScoreCard.Pages.IndexModel
@{
ViewData["Title"] = "Home";
}

@section Styles {
<link rel="stylesheet" href="/css/index.css" />
}

@await Html.PartialAsync("_PartialHero")
]
@section Scripts {
    <script>
    const input = document.getElementById("courseSearch");
    const dropdown = document.getElementById("dropdown");

    input.addEventListener("input", async () => {
        const query = input.value.trim();
        dropdown.innerHTML = "";

        if (query.length < 2) {
            dropdown.style.display = "none";
            return;
        }

        try {
            const res = await fetch(`/api/golfcourses?query=${encodeURIComponent(query)}`);
            const data = await res.json();

            // ✅ ADD THIS LINE RIGHT HERE
            console.log("API response:", data);

            const courses = data?.courses || [];
            if (courses.length === 0) {
                dropdown.style.display = "none";
                return;
            }

            courses.slice(0, 10).forEach(course => {
                const div = document.createElement("div");
                div.textContent = `${course.club_name} – ${course.course_name}`;
                div.onclick = () => {
                    input.value = course.name;
                    dropdown.innerHTML = "";
                    dropdown.style.display = "none";
                };
                dropdown.appendChild(div);
            });

            dropdown.style.display = "block";
        } catch (err) {
            console.error("Error fetching API data:", err);
        }
    });

    document.addEventListener("click", (e) => {
        if (!document.querySelector(".search-wrapper").contains(e.target)) {
            dropdown.innerHTML = "";
            dropdown.style.display = "none";
        }
    });
</script>
}




